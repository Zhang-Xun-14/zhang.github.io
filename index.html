<!DOCTYPE html>
<html dir="ltr" lang="zh" class="" style="background-color: rgb(169, 210, 250); --ntp-theme-text-color:rgba(0, 0, 0, 1);">
<head>
    <meta charset="UTF-8">
    <title>未来15日天气</title>
    <script src="https://cdn.staticfile.org/axios/1.4.0/axios.js"></script>
    <script src="https://cdn.staticfile.org/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/Chart.js/3.9.1/chart.js"></script>
</head>
<body>
    <div id="myChart"></div>
    <script>
        settings = {
            "async": true,
            "crossDomain": true,
            "url": "https://tianqi.so.com/weather/101090501",
            "method": "GET",
            "headers": {
                "cookie": "gtHuid=1; QiHooGUID=B596172DBE891468A74B81FCD6EB112E.1672393532183; __guid=22834110.2908955363674071600.1672393532617.4385; __huid=11MLkijflYnLe9jDPQ%252BaJ3bvcneu5RKEKkKA%252FHdabZMxI%253D; so_huid=11MLkijflYnLe9jDPQ%252BaJ3bvcneu5RKEKkKA%252FHdabZMxI%253D; __asc=58e435618dceb4fcbbd88a5f299ff9f3.10e7.1673568556129; __asc2=11c8210619b583fc478c0d465b52d528a98a39d1d334.1126.1673568556129; so_md=3hf167356855614004d4f5bc6bdcfbb8a4a5b72a7520eea.1; __md=oqf04d4f5bc6bdcfbab7461abef43bb8a4a5b72a7520eea.14; __DC_monitor_count=1; __DC_sid=22834110.979697392121992400.1682755946857.4949; __DC_gid=22834110.369665646.1672393532617.1682755947324.212",
                "authority": "tianqi.so.com",
                "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
                "accept-language": "zh-CN,zh;q=0.9",
                "cache-control": "no-cache",
                "pragma": "no-cache",
                "sec-ch-ua": "\"Not?A_Brand\";v=\"8\", \"Chromium\";v=\"108\", \"Google Chrome\";v=\"108\"",
                "sec-ch-ua-mobile": "?0",
                "sec-ch-ua-platform": "\"Windows\"",
                "sec-fetch-dest": "document",
                "sec-fetch-mode": "navigate",
                "sec-fetch-site": "none",
                "sec-fetch-user": "?1",
                "upgrade-insecure-requests": "1",
                "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36"
            }
        };

        $.ajax(settings).done(function (response) {
            console.log(response);
            var list = response.ready(function(){
                $("div.weather-card > ul.weather-columns > li > div")
            });
            var dates = [], weather = [], temperature = [], wind = [], index = -1;
            for (let i = 0; i < list.length; i++) {
                var divd = list.eq(i).text();
                index += 1;
                switch (index % 7){
                    case 0:
                    case 2:
                    break;
                    case 1: dates.push(divd)
                    break;
                    case 3: weather.push(divd.replace("\\n", "").trim())
                    break;
                    case 4: temperature.push(divd)
                    break;
                    case 5: 
                        if (divd.includes('风')){
                            wind.push(divd);
                            hello += 1;
                        }
                    break;
                    default: wind.push(divd)
                }
            }
            var days = [];
            for (let len = 0; len < dates.length; len++) {
                days.push(dates[len] + "\n" + wind[len] + "" + weather[len]);
            }
            var low = [], high = [];
            for (let key = 0; key < temperature.length; key++) {
                const element = temperature[key].split("/");
                low.push(element[0]);
                high.push(element[1].replace("℃", ""));
            }
            const ctx = document.getElementById('myChart');
            const datas = {
                labels: days,
                datasets: [{
                    type: 'line',
                    label: '折线图数据集最低气温',
                    data: low,
                    borderColor: 'rgb(62, 48, 253)',
                }, {
                    type: 'line',
                    label: '折线图数据集最高气温',
                    data: high,
                    fill: false,
                    borderColor: 'rgb(255, 160, 26)'
                }]
            };
            const config = {
                type: 'scatter',
                data: datas,
                options: {
                    responsive: true, // 设置图表为响应式，根据屏幕窗口变化而变化
                    maintainAspectRatio: false,// 保持图表原有比例
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            };
            const myChart = new Chart(ctx, config);
        });
    </script>
    <!-- <div style="background-color: rgb(255, 160, 26)"></div> -->
</body>
</html>
